var dataJson = [
  {
    "questions.subject": {
      value: "Preparation of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 109,
    },
    "fact_table.priority_score": {
      value: 2.339506578145407,
      rendered: "2.34",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.7369917395871368,
      rendered: "0.74",
      html: "1.  Preparation of interview(s)  0.74 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.8256,
      rendered: "6.83",
      html: "6.8 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency interviewer",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 105,
    },
    "fact_table.priority_score": {
      value: 1.6824157393369028,
      rendered: "1.68",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.7269652764710293,
      rendered: "0.73",
      html: "7.  Proficiency interviewer  0.73 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.6857,
      rendered: "7.69",
      html: "7.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency recruiter",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 105,
    },
    "fact_table.priority_score": {
      value: 1.8604767847133983,
      rendered: "1.86",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.7371436208698436,
      rendered: "0.74",
      html: "4.  Proficiency recruiter  0.74 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.4761,
      rendered: "7.48",
      html: "7.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick response",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 104,
    },
    "fact_table.priority_score": {
      value: 0.613142831810023,
      rendered: "0.61",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.30805005617464987,
      rendered: "0.31",
      html: "27.  Quick response  0.31 ",
    },
    "fact_table.avg_star_rating": {
      value: 8.0096,
      rendered: "8.01",
      html: "8.0 ",
    },
  },
  {
    "questions.subject": {
      value: "Easy to find job online",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 98,
    },
    "fact_table.priority_score": {
      value: 0.28290230542094635,
      rendered: "0.28",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.298105695912483,
      rendered: "0.30",
      html: "35.  Easy to find job online  0.30 ",
    },
    "fact_table.avg_star_rating": {
      value: 9.051,
      rendered: "9.05",
      html: "9.1 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick and easy application form",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 93,
    },
    "fact_table.priority_score": {
      value: 0.1443440309784715,
      rendered: "0.14",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.08337802159107642,
      rendered: "0.08",
      html: "39.  Quick and easy application form  0.08 ",
    },
    "fact_table.avg_star_rating": {
      value: 8.2688,
      rendered: "8.27",
      html: "8.3 ",
    },
  },
  {
    "questions.subject": {
      value: "Speed of the process",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 93,
    },
    "fact_table.priority_score": {
      value: 1.213541756145845,
      rendered: "1.21",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.4993588001587708,
      rendered: "0.50",
      html: "17.  Speed of the process  0.50 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.5698,
      rendered: "7.57",
      html: "7.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Planning of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 92,
    },
    "fact_table.priority_score": {
      value: 1.643920037214407,
      rendered: "1.64",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.5794571861876654,
      rendered: "0.58",
      html: "9.  Planning of interview(s)  0.58 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.163,
      rendered: "7.16",
      html: "7.2 ",
    },
  },
  {
    "questions.subject": {
      value: "Useful job advertisement",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 80,
    },
    "fact_table.priority_score": {
      value: 0.137334331266348,
      rendered: "0.14",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.0998795136482531,
      rendered: "0.10",
      html: "40.  Useful job advertisement  0.10 ",
    },
    "fact_table.avg_star_rating": {
      value: 8.625,
      rendered: "8.63",
      html: "8.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Amount of communication",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q2",
    },
    "fact_table.ratings": {
      value: 77,
    },
    "fact_table.priority_score": {
      value: 1.857697373095842,
      rendered: "1.86",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.6684047685013643,
      rendered: "0.67",
      html: "5.  Amount of communication  0.67 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.2207,
      rendered: "7.22",
      html: "7.2 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency interviewer",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 39,
    },
    "fact_table.priority_score": {
      value: 1.577298251009654,
      rendered: "1.58",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.6090424940187096,
      rendered: "0.61",
      html: "11.  Proficiency interviewer  0.61 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.4102,
      rendered: "7.41",
      html: "7.4 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency recruiter",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 39,
    },
    "fact_table.priority_score": {
      value: 1.142935219141584,
      rendered: "1.14",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.47927840782554787,
      rendered: "0.48",
      html: "18.  Proficiency recruiter  0.48 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.6153,
      rendered: "7.62",
      html: "7.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick response",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 35,
    },
    "fact_table.priority_score": {
      value: 0.9315005544084278,
      rendered: "0.93",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.267227194448456,
      rendered: "0.27",
      html: "22.  Quick response  0.27 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.5142,
      rendered: "6.51",
      html: "6.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick and easy application form",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 33,
    },
    "fact_table.priority_score": {
      value: 0.5046776154909192,
      rendered: "0.50",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.22205104518255858,
      rendered: "0.22",
      html: "31.  Quick and easy application form  0.22 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.7272,
      rendered: "7.73",
      html: "7.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Planning of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 32,
    },
    "fact_table.priority_score": {
      value: 1.2483978999649317,
      rendered: "1.25",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.4161326333216439,
      rendered: "0.42",
      html: "16.  Planning of interview(s)  0.42 ",
    },
    "fact_table.avg_star_rating": {
      value: 7,
      rendered: "7.00",
      filterable_value: "7.0",
      html: "7.0 ",
    },
  },
  {
    "questions.subject": {
      value: "Preparation of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 31,
    },
    "fact_table.priority_score": {
      value: 1.050132169394292,
      rendered: "1.05",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.29594526248289144,
      rendered: "0.30",
      html: "19.  Preparation of interview(s)  0.30 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.4516,
      rendered: "6.45",
      html: "6.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Preparation of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 28,
    },
    "fact_table.priority_score": {
      value: 1.9278041899180234,
      rendered: "1.93",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.8433827062376513,
      rendered: "0.84",
      html: "3.  Preparation of interview(s)  0.84 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.7142,
      rendered: "7.71",
      html: "7.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Speed of the process",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 28,
    },
    "fact_table.priority_score": {
      value: 0.28802788200974055,
      rendered: "0.29",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.08765837300192968,
      rendered: "0.09",
      html: "34.  Speed of the process  0.09 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.7142,
      rendered: "6.71",
      html: "6.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick and easy application form",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 28,
    },
    "fact_table.priority_score": {
      value: 0.36550291025063514,
      rendered: "0.37",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.1599015269273931,
      rendered: "0.16",
      html: "32.  Quick and easy application form  0.16 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.7142,
      rendered: "7.71",
      html: "7.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Easy to find job online",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 27,
    },
    "fact_table.priority_score": {
      value: 0.545673280936959,
      rendered: "0.55",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.19909270320233471,
      rendered: "0.20",
      html: "29.  Easy to find job online  0.20 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.2592,
      rendered: "7.26",
      html: "7.3 ",
    },
  },
  {
    "questions.subject": {
      value: "Preparation of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 27,
    },
    "fact_table.priority_score": {
      value: 0.9620744458218445,
      rendered: "0.96",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.17551298838307847,
      rendered: "0.18",
      html: "21.  Preparation of interview(s)  0.18 ",
    },
    "fact_table.avg_star_rating": {
      value: 4.5185,
      rendered: "4.52",
      html: "4.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick response",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 26,
    },
    "fact_table.priority_score": {
      value: 0.6042190356527085,
      rendered: "0.60",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.17263401018648813,
      rendered: "0.17",
      html: "28.  Quick response  0.17 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.5,
      rendered: "6.50",
      html: "6.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Speed of the process",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 26,
    },
    "fact_table.priority_score": {
      value: 0.803349445279761,
      rendered: "0.80",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.22703107115437643,
      rendered: "0.23",
      html: "24.  Speed of the process  0.23 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.4615,
      rendered: "6.46",
      html: "6.5 ",
    },
  },
  {
    "questions.subject": {
      value: "Useful job advertisement",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 26,
    },
    "fact_table.priority_score": {
      value: 0.2182696895630358,
      rendered: "0.22",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.08106881947817404,
      rendered: "0.08",
      html: "37.  Useful job advertisement  0.08 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.3076,
      rendered: "7.31",
      html: "7.3 ",
    },
  },
  {
    "questions.subject": {
      value: "Planning of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 24,
    },
    "fact_table.priority_score": {
      value: 0.7101377480506776,
      rendered: "0.71",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.24347301678289765,
      rendered: "0.24",
      html: "26.  Planning of interview(s)  0.24 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.0833,
      rendered: "7.08",
      html: "7.1 ",
    },
  },
  {
    "questions.subject": {
      value: "Easy to find job online",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 24,
    },
    "fact_table.priority_score": {
      value: 1.4284076633220322,
      rendered: "1.43",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.5910570874837722,
      rendered: "0.59",
      html: "13.  Easy to find job online  0.59 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.5833,
      rendered: "7.58",
      html: "7.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency interviewer",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 24,
    },
    "fact_table.priority_score": {
      value: 1.6707279387027105,
      rendered: "1.67",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.549274398758165,
      rendered: "0.55",
      html: "8.  Proficiency interviewer  0.55 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.9583,
      rendered: "6.96",
      html: "7.0 ",
    },
  },
  {
    "questions.subject": {
      value: "Useful job advertisement",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 23,
    },
    "fact_table.priority_score": {
      value: 0.5135852813991472,
      rendered: "0.51",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.17119509379971573,
      rendered: "0.17",
      html: "30.  Useful job advertisement  0.17 ",
    },
    "fact_table.avg_star_rating": {
      value: 7,
      rendered: "7.00",
      filterable_value: "7.0",
      html: "7.0 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency recruiter",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 23,
    },
    "fact_table.priority_score": {
      value: 1.288062296728277,
      rendered: "1.29",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.45577378604022406,
      rendered: "0.46",
      html: "15.  Proficiency recruiter  0.46 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.1739,
      rendered: "7.17",
      html: "7.2 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency recruiter",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 23,
    },
    "fact_table.priority_score": {
      value: 1.4601577102284575,
      rendered: "1.46",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.6458302933470996,
      rendered: "0.65",
      html: "12.  Proficiency recruiter  0.65 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.7391,
      rendered: "7.74",
      html: "7.7 ",
    },
  },
  {
    "questions.subject": {
      value: "Proficiency interviewer",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 23,
    },
    "fact_table.priority_score": {
      value: 1.5951581499667271,
      rendered: "1.60",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.7487247828991913,
      rendered: "0.75",
      html: "10.  Proficiency interviewer  0.75 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.8695,
      rendered: "7.87",
      html: "7.9 ",
    },
  },
  {
    "questions.subject": {
      value: "Easy to find job online",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 23,
    },
    "fact_table.priority_score": {
      value: 0.34903230767856225,
      rendered: "0.35",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.25084972522535737,
      rendered: "0.25",
      html: "33.  Easy to find job online  0.25 ",
    },
    "fact_table.avg_star_rating": {
      value: 8.6086,
      rendered: "8.61",
      html: "8.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick response",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 20,
    },
    "fact_table.priority_score": {
      value: 1.7109360475921593,
      rendered: "1.71",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.6221585627607852,
      rendered: "0.62",
      html: "6.  Quick response  0.62 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.25,
      rendered: "7.25",
      html: "7.3 ",
    },
  },
  {
    "questions.subject": {
      value: "Amount of communication",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q1",
    },
    "fact_table.ratings": {
      value: 18,
    },
    "fact_table.priority_score": {
      value: 0.7119639932224674,
      rendered: "0.71",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.27858976100425237,
      rendered: "0.28",
      html: "25.  Amount of communication  0.28 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.4444,
      rendered: "7.44",
      html: "7.4 ",
    },
  },
  {
    "questions.subject": {
      value: "Useful job advertisement",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 18,
    },
    "fact_table.priority_score": {
      value: 0.8268318608887242,
      rendered: "0.83",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.33824171032469796,
      rendered: "0.34",
      html: "23.  Useful job advertisement  0.34 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.5555,
      rendered: "7.56",
      html: "7.6 ",
    },
  },
  {
    "questions.subject": {
      value: "Amount of communication",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q4",
    },
    "fact_table.ratings": {
      value: 18,
    },
    "fact_table.priority_score": {
      value: 0.16580791662929406,
      rendered: "0.17",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.05426361978966293,
      rendered: "0.05",
      html: "38.  Amount of communication  0.05 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.9444,
      rendered: "6.94",
      html: "6.9 ",
    },
  },
  {
    "questions.subject": {
      value: "Quick and easy application form",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 18,
    },
    "fact_table.priority_score": {
      value: 0.9633930120391303,
      rendered: "0.96",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.3689464660076326,
      rendered: "0.37",
      html: "20.  Quick and easy application form  0.37 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.3888,
      rendered: "7.39",
      html: "7.4 ",
    },
  },
  {
    "questions.subject": {
      value: "Speed of the process",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 14,
    },
    "fact_table.priority_score": {
      value: 1.3781628437629856,
      rendered: "1.38",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.44869374695197317,
      rendered: "0.45",
      html: "14.  Speed of the process  0.45 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.9285,
      rendered: "6.93",
      html: "6.9 ",
    },
  },
  {
    "questions.subject": {
      value: "Planning of interview(s)",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 14,
    },
    "fact_table.priority_score": {
      value: 0.21918630068765743,
      rendered: "0.22",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.08075242260901795,
      rendered: "0.08",
      html: "36.  Planning of interview(s)  0.08 ",
    },
    "fact_table.avg_star_rating": {
      value: 7.2857,
      rendered: "7.29",
      html: "7.3 ",
    },
  },
  {
    "questions.subject": {
      value: "Amount of communication",
    },
    "fact_table.filterdate_quarter_of_year": {
      value: "Q3",
    },
    "fact_table.ratings": {
      value: 8,
    },
    "fact_table.priority_score": {
      value: 1.9403870715523999,
      rendered: "1.94",
    },
    "fact_table.abs_correlation_coefficient": {
      value: 0.5749295026821926,
      rendered: "0.57",
      html: "2.  Amount of communication  0.57 ",
    },
    "fact_table.avg_star_rating": {
      value: 6.625,
      rendered: "6.63",
      html: "6.6 ",
    },
  },
];

var fakedata = [
  {
      "questions.subject": {
          "value": "Communication & Managing Expectations",
          "filterable_value": "\"Communication & Managing Expectations\""
      },
      "questions.question": {
          "value": "The talent team managed my expectations around the process and its timeline"
      },
      "fact_table.ratings": {
          "value": 215
      },
      "fact_table.priority_score": {
          "value": 0.7107470294353965,
          "rendered": "0.71"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.8259698192160331,
          "rendered": "0.83",
          "html": "1.  Communication &amp; Managing Expectations  0.83 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.1395,
          "rendered": "9.14",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Communication+%26+Managing+Expectations&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Preparation for Interview(s)"
      },
      "questions.question": {
          "value": "I felt that the recruiter prepared me well for my interview(s)"
      },
      "fact_table.ratings": {
          "value": 208
      },
      "fact_table.priority_score": {
          "value": 0.5454518375768385,
          "rendered": "0.55"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.6338041338331843,
          "rendered": "0.63",
          "html": "2.  Preparation for Interview(s)  0.63 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.1394,
          "rendered": "9.14",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Preparation+for+Interview%28s%29&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Scheduling of Interview(s)"
      },
      "questions.question": {
          "value": "The scheduling of the interview(s) went smoothly"
      },
      "fact_table.ratings": {
          "value": 213
      },
      "fact_table.priority_score": {
          "value": 0.5274579013419872,
          "rendered": "0.53"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7801477611921124,
          "rendered": "0.78",
          "html": "3.  Scheduling of Interview(s)  0.78 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.3239,
          "rendered": "9.32",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Scheduling+of+Interview%28s%29&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Screening"
      },
      "questions.question": {
          "value": "The recruiter asked questions that allowed me to highlight my skills and experience"
      },
      "fact_table.ratings": {
          "value": 216
      },
      "fact_table.priority_score": {
          "value": 0.5231815383596713,
          "rendered": "0.52"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7687063449304604,
          "rendered": "0.77",
          "html": "4.  Screening  0.77 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.3194,
          "rendered": "9.32",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Screening&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Role Expectations & Team",
          "filterable_value": "\"Role Expectations & Team\""
      },
      "questions.question": {
          "value": "The interviewer(s) gave me a thorough understanding of expectations in the role and the culture of the team"
      },
      "fact_table.ratings": {
          "value": 214
      },
      "fact_table.priority_score": {
          "value": 0.4810462374440643,
          "rendered": "0.48"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7300747267325304,
          "rendered": "0.73",
          "html": "5.  Role Expectations &amp; Team  0.73 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.3411,
          "rendered": "9.34",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Role+Expectations+%26+Team&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Interview Preparation"
      },
      "questions.question": {
          "value": "I could tell that the interviewer(s) I spoke with was/were well prepared"
      },
      "fact_table.ratings": {
          "value": 213
      },
      "fact_table.priority_score": {
          "value": 0.47107648455567763,
          "rendered": "0.47"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7658534946442491,
          "rendered": "0.77",
          "html": "6.  Interview Preparation  0.77 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.3849,
          "rendered": "9.38",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Interview+Preparation&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Asking Questions"
      },
      "questions.question": {
          "value": "You had the opportunity to learn about the team and the challenges in the role"
      },
      "fact_table.ratings": {
          "value": 213
      },
      "fact_table.priority_score": {
          "value": 0.3614719599180735,
          "rendered": "0.36"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.733208843647208,
          "rendered": "0.73",
          "html": "7.  Asking Questions  0.73 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.507,
          "rendered": "9.51",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Asking+Questions&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Engagement"
      },
      "questions.question": {
          "value": "The interviewer(s) were engaged and interested in my profile"
      },
      "fact_table.ratings": {
          "value": 214
      },
      "fact_table.priority_score": {
          "value": 0.3327401954610523,
          "rendered": "0.33"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7656240116453114,
          "rendered": "0.77",
          "html": "8.  Engagement  0.77 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.5654,
          "rendered": "9.57",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Engagement&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "%company values D&I",
          "filterable_value": "\"%company values D&I\""
      },
      "questions.question": {
          "value": "Based on your experience, do you feel %company is a company that values diversity and inclusion?",
          "filterable_value": "\"Based on your experience, do you feel %company is a company that values diversity and inclusion?\""
      },
      "fact_table.ratings": {
          "value": 208
      },
      "fact_table.priority_score": {
          "value": 0.2663291173349557,
          "rendered": "0.27"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.6673242729515302,
          "rendered": "0.67",
          "html": "9.  %company values D&amp;I  0.67 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.6009,
          "rendered": "9.60",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=%25company+values+D%26I&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Interview Atmosphere"
      },
      "questions.question": {
          "value": "The interviewer(s) provided a safe environment to openly express myself and ask questions"
      },
      "fact_table.ratings": {
          "value": 213
      },
      "fact_table.priority_score": {
          "value": 0.25269383682485236,
          "rendered": "0.25"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.6563476281164996,
          "rendered": "0.66",
          "html": "10.  Interview Atmosphere  0.66 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.615,
          "rendered": "9.62",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Interview+Atmosphere&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  },
  {
      "questions.subject": {
          "value": "Respectful Hiring"
      },
      "questions.question": {
          "value": "I feel I could be my authentic self during the interviews and was treated respectfully by my interviewer(s)"
      },
      "fact_table.ratings": {
          "value": 211
      },
      "fact_table.priority_score": {
          "value": 0.1925151945451302,
          "rendered": "0.19"
      },
      "fact_table.abs_correlation_coefficient": {
          "value": 0.7251043109044452,
          "rendered": "0.73",
          "html": "11.  Respectful Hiring  0.73 "
      },
      "fact_table.avg_star_rating_with_link": {
          "value": 9.7345,
          "rendered": "9.73",
          "links": [
              {
                  "label": "Question Drill Down Dashboard",
                  "url": "/dashboards/2708?uniqueformid=42768&subject=Respectful+Hiring&filterdate=&npsrating=&npscategory=&tagvalue1=&tagvalue2=&tagvalue3=&tagvalue4=&tagvalue5=&tagvalue6=&tagvalue7=&tagvalue8=&tagvalue9=&tagvalue10=&tagvalue11=&tagvalue12=&tagvalue13=&tagvalue14=&tagvalue15=&tagvalue16=&tagvalue17=&tagvalue18=&tagvalue19=&tagvalue20=&tagvalue21=&tagvalue22=&tagvalue23=&tagvalue24=&tagvalue25=&tagvalue26=&tagvalue27=&tagvalue28=&tagvalue29=&tagvalue30=&tagvalue31=&tagvalue32=&tagvalue33=&tagvalue34=&tagvalue35=&tagvalue36=&tagvalue37=&tagvalue38=&tagvalue39=&tagvalue40=&tagvalue41=&tagvalue42=&tagvalue43=&tagvalue44=&tagvalue45=&tagvalue46=&tagvalue47=&tagvalue48=&tagvalue49=&tagvalue50=&source=&recruiter=",
                  "type": "dashboard"
              }
          ]
      }
  }
]
var emptyData = false
function visual() {
  // set the dimensions and margins of the graph
  var margin = {top: 10, right: 30, bottom: 30, left: 60},
      width = 850 - margin.left - margin.right,
      height = 550 - margin.top - margin.bottom;

  // append the svg object to the body of the page
  var svg = d3.select("#vis")
              .style('font-family', 'Open Sans, sans-serif')
              .style('color', 'rgb(105, 105, 105)')
              .append('div')
              .attr('id', 'chart')
              .style('display', 'inline-block')
              .style('position', 'relative')
                .append("svg")
                  .style('position', 'fixed')
                  .attr('overflow', 'visible')
                  .attr("width", '100%' )
                  // .attr("height", height + margin.top + margin.bottom)
                  .attr("height", '100vh')
                  .attr("max-height", '950px')
                  // .attr('viewBox', '0 0 816 550')
                  .attr('viewBox', '0 0 1110 600');
                  
  var visual = svg.append("g")
                  .attr("transform", "translate(" + 30 + "," + margin.top + ")");
  
  var legend = svg.append("g")
                  .attr("transform", "translate(" + 820 + "," + margin.top + ")");
  
  var legendTypo = svg.append("g")
                  .attr("transform", "translate(" + 860 + "," + margin.top + ")");
  
  const minX = d3.min(fakedata, d => d['fact_table.avg_star_rating_with_link']['rendered'])
  const maxX = d3.max(fakedata, d => d['fact_table.avg_star_rating_with_link']['rendered'])
  // var sum = 0
  // function sumTotalRate() {
  //   for (var i = 0, n = data_ready.length-1; n >= i; n--) { 
  //     sum += data_ready[n]['fact_table.ratings']['value']; 
  //   }
  //   return sum
  // }
  // console.log('Sum :', sumTotalRate())
  const totlaRatingResponses = fakedata.reduce((acc, d) => acc + d['fact_table.ratings']['value'], 0)
  console.log('totlaRatingResponses', totlaRatingResponses)

  //   Add X axis
  var x = d3.scaleLinear()
    .domain([ minX, maxX ])
    .range([ 0, width ]).nice();
  
  var xAxis = d3.axisBottom(x)
  
  visual.append("g")
    .attr("transform", "translate(0," + (height+2) + ")")
    .call(xAxis)
    .call(g => g.select(".domain").remove());
  
  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, 1])
    .range([height, 0]);
  
  visual.append("g")
    .call(d3.axisLeft(y))
    .call(g => g.select(".domain").remove());
  
  var arryOfAvg = xAxis.scale().ticks()
  console.log(arryOfAvg)
  
  // var midItem = ( (arryOfAvg[arryOfAvg.length -1] - arryOfAvg[0]) / 2 ) + arryOfAvg[0]

  var avg_satisfaction = "9.24"
console.log(avg_satisfaction)
  var colors = []
  function colorMatcher() {
    fakedata.forEach(d => {
      if(d['fact_table.abs_correlation_coefficient']['rendered'] >= 0.5 && d['fact_table.avg_star_rating_with_link']['rendered'] <= avg_satisfaction) {
        return colors.push("#f29696") // red
      }
      if(d['fact_table.abs_correlation_coefficient']['rendered'] <= 0.5 && d['fact_table.avg_star_rating_with_link']['rendered'] <= avg_satisfaction) {
          return colors.push("#f7e39c") // yellow
      }
      if (d['fact_table.abs_correlation_coefficient']['rendered'] >= 0.5 && d['fact_table.avg_star_rating_with_link']['rendered'] >= avg_satisfaction) {
          return colors.push("#bddaa5") // green
      }
      if (d['fact_table.abs_correlation_coefficient']['rendered'] <= 0.5 && d['fact_table.avg_star_rating_with_link']['rendered'] >= avg_satisfaction) {
          return colors.push("#d5e8ff") // blue
      }
    })
    return colors
  }
  const colorMatchs = colorMatcher();

  var seqWidth = [];
  function widthCalc() {
    const containerWidth = width
    const leftWidthCont = (avg_satisfaction - arryOfAvg[0]) / (arryOfAvg[arryOfAvg.length -1] - arryOfAvg[0]) * containerWidth

    seqWidth = {
      leftWidth: leftWidthCont,
      rightWidth: containerWidth - leftWidthCont
    }
  
    return seqWidth
  }
  
  const widthCalculator = widthCalc();
console.log(widthCalculator.leftWidth)
  var divGroup = [
    {
      "class": "topLeft",
      "transform": 'translate(0px, 0px)',
      "color": "#f29696", // red
      "text": "Improve",
      "alignment": "left",
      'width': widthCalculator.leftWidth
    }, {
      "class": "topRight",
      "transform": "translate("+ (widthCalculator.leftWidth + 10 + 'px') +", 0px)",
      "color": "#bddaa5", // green
      "text": "Leverage",
      "alignment": "end",
      'width': widthCalculator.rightWidth - 10
    }, {
      "class": "bottomLeft",
      "transform": 'translate(0px, 260px)',
      "color": "#f7e39c", // yellow
      "text": "Monitor",
      "alignment": "left",
      'width': widthCalculator.leftWidth
    }, {
      "class": "bottomRight",
      "transform": "translate("+ (widthCalculator.leftWidth + 10 + 'px') +", 260px)",
      "color": "#d5e8ff", // blue
      "text": "Maintain",
      "alignment": "end",
      'width': widthCalculator.rightWidth - 10
    }
  ];

  //colored boxes with text inside
  visual.append('g')
    .selectAll("foreignObject")
    .data(divGroup)
    .enter()
    .append("foreignObject")
      .attr('width', function (d) { return d.width + 'px' })
      .attr('height', '250px')
      .attr('class', function (d) {return d.class;})
      .attr("fill", function (d) {return d.color})
      .style('background-color', function (d) {return d.color})
      .style('height', '250px')
      .style("padding", "5px")
      .style('border-radius', '10px')
      .style("transform", function (d) {return d.transform})
    .append("xhtml:div")
    .style('background-color', function (d) {return d.color})
    .style("height", "100%")
    .style("text-align", function (d) {return d.alignment})
    .style("padding", "5px")
    .on('click', function() {
        tooltip.style("visibility", "hidden");
    })
    .html(d => d.text);

  //Tooltips
  var tooltip = d3.select("#chart")
    .data(fakedata.slice(0, 25))
    .append("foreignObject")
    .style("visibility", "hidden")
    .style("font-size", '12px')
    .style("background-color", 'rgba(34, 42, 60, 0.9)')
    .style('color', '#ffffff')
    .style('border-radius', '5px')
    .style('padding', '10px')
    .style('position', 'absolute')
    .style('z-index', '3')
    .style('width', '180px');
  
  // Circles with text inside
  var elemEnter = visual.append('g').selectAll('g myCircleText')
    .data(fakedata.slice(0, 25))
    .enter()
    .append("g")
    .style('cursor', 'pointer')
    .attr("transform", function(d){return "translate("+ (x(d['fact_table.avg_star_rating_with_link']['rendered'])) +","+ (y(d['fact_table.abs_correlation_coefficient']['rendered'])) +")"});
    
  // Circles click functionalities
  elemEnter.on("click", function(d) {
    const subject = d['questions.subject'] ? d['questions.subject']['value'] : '';
    const subjectElement = subject ? `<strong style="font-size: 13px; line-height: 24px">${subject}</strong> <br>` : '';
    const question = d['survey_question.question'] ? d['survey_question.question']['value'] + '?' : '';
    const questionElement = question ? `<strong style="font-size: 11px; display: block; margin: 5px 0;">${question}</strong>` : '';
    tooltip.style("visibility", "visible")
    tooltip.html(
        subjectElement + 
        questionElement +
        `<span style="line-height: 26px">Ratings: </span>` + 
        `<strong style="font-size: 13px; font-family: Arial, Helvetica, sans-serif;">${d["questions.subject"]['value']}</strong>` + 
        `<br> <span style="line-height: 26px">Satisfaction: </span>` + 
        `<strong style="font-size: 13px; font-family: Arial, Helvetica, sans-serif">${d['fact_table.avg_star_rating_with_link']['rendered']}</strong>` +
        `<br> <span style="line-height: 26px">Correlation (NPS): </span>` + 
        `<strong style="font-size: 13px; font-family: Arial, Helvetica, sans-serif;">${d['fact_table.abs_correlation_coefficient']['rendered']}</strong><br><br>` 
    )
    .style("left", (d3.event.pageX) + "px")
    .style("top", (d3.event.pageY) + "px");

    // urls is been commited in the newData in order to check the argument validity
    if (d["questions.subject"].links) {
      var cta = tooltip.append('a')
          .style('cursor', 'pointer')
          .html(`<strong 
              style="
              width: 140px;
              background-color: blue; 
              padding: 5px 10px; 
              border-radius: 10px;
              margin: auto;
              display: block;
              text-align: center;
              font-family: Arial, Helvetica, sans-serif;
              ">Inspect item</strong>`);
      cta.on('click', function (d) {
        window.open(d["questions.subject"].links[0].url, "_self")
      });
    }
  });
    
  /*Create the circle for each block */
  var circle = elemEnter.append("circle")
    .attr("r", 12 )
    .attr("fill", "white")
    .attr("stroke", "rgb(51, 51, 51)")
    .attr("stroke-width", 1)
    .style('cursor', 'pointer')
    .style('filter', 'drop-shadow(2px 2px 2px rgba(9, 9, 9, 0.2))');
     
  /* Create the text for each block */
  elemEnter.append("text")
    .attr("dx", function(d, i){return i >= 9 ? -7 : -4})
    .attr("dy", function(d){return 5})
    .style("font-size", "12px")
    .text(function(d, i){return i + 1});
    
  // Legend section
  var legendCircle = legend.selectAll('foreignObject')
    .data(colorMatchs.slice(0, 10))
    .enter();
    
  legendCircle.append('foreignObject')
    .attr('x', 0 )
    .attr('y', function(d, i) { return i*50; })
    .style('background-color', function(d, i) {return d})
    .attr('width', '25px')
    .attr('height', '25px')
    .style('border-radius', '100%')
    .append("xhtml:div")
    .style('border-radius', '100%')
    .style('width', '25px')
    .style('height', '25px')
    .style('display', 'flex')
    .style('justify-content', 'center')
    .style('align-items', 'center')
    .style('background-color', function(d, i) {return d})
    .html(function(d, i) { return i + 1 });
    
  legendTypo.selectAll('foreignObject')
    .data(fakedata.slice(0, 10))
    .enter()
    .append('foreignObject')
    .attr('x', 0 )
    .attr('y', function(d, i) { return i*50 })
    .attr('width', '200px')
    .attr('height', '40px')
    .style('line-height', '20px')
    .append("xhtml:div")
    .style('width', '200px')
    .style('height', '40px')
    .style('line-height', '20px')
    .style('-webkit-box-orient', 'vertical')
    .style('-webkit-line-clamp', '2')
    .style('display', '-webkit-box')
    .html(function(d, i) { return d['questions.subject']['value'] });

    //Learn more
    svg.append("svg:a")
    .attr("xlink:href", 'https://support.starred.com/docs/starred-matrix-1')
    .attr("target", "_blank")
    .append("svg:text")
    .attr('width', '200px')
    .attr('height', '40px')
    .attr('fill', '#0000EE')
    .attr('font-size', 12)
    .attr("transform", "translate(" + 10 + "," + (height + 60) + ")")
    .html(`Learn more`)

    svg.append("svg:text")
    .attr("fill", 'rgb(105, 105, 105)')
    .attr('font-size', 12)
    .html(`about how to interpret the priority matrix.`)
    .attr("transform", "translate(" + 80 + "," + (height + 60) + ")");
}
//=== Visual end here ===//

//Display message if response is not enough
function message() {
  var svg = d3.select("#vis")
  .style('font-family', 'Open Sans, sans-serif')
  .style('color', 'rgb(105, 105, 105)')
  .append("svg")
  .attr('overflow', 'visible')
  .attr("width", '100%' )
  .attr("height", '100vh')
  .attr("position", "fixed")
  .attr("max-height", '950px').attr('viewBox', '0 0 1110 600');

  svg.append("image")
  .attr('xlink:href', 'https://cdn.starred.com/downloads/looker/not-found.png')
  .attr("width", "100%")
  .attr("height", "100%");
  // .style("backdrop-filter", "blur(3rem)")
  // .style("filter", "blur(4px)");

  // svg.append("foreignObject")
  // .style("width", "100%")
  // .style("height", "100%")
  // .style("background", "rgba(255, 255, 255, 0.2)");

  // var container = svg.append("foreignObject")
  // .style("width", '50%')
  // .style("height", "300px")
  // .style("border", '1px solid')
  // .style("padding-top", "120px")
  // .style("transform", "translate(290px, 150px)")
  // .style("border-radius", "5px")
  // .style("background-color", "white");

  // var emoji = svg.append("g")
  
  // var main = emoji.append("circle")
  // .attr('r', 23)
  // .attr('cx', 560)
  // .attr('cy', 225)
  // .attr('fill', 'white')
  // .attr('stroke', 'rgb(226,135,67)')
  // .attr("stroke-width", 3);

  // var leftEye = emoji.append("circle")
  // .attr('r', 3)
  // .attr('cx', 550)
  // .attr('cy', 220)
  // .attr('fill', 'rgb(226,135,67)')
  // .attr('stroke', 'rgb(226,135,67)');

  // var rightEye = emoji.append("circle")
  // .attr('r', 3)
  // .attr('cx', 570)
  // .attr('cy', 220)
  // .attr('fill', 'rgb(226,135,67)')
  // .attr('stroke', 'rgb(226,135,67)');

  // var mouth = emoji.append("path")
  // .attr('transform', 'translate(555, 240)')
  // .attr('stroke', 'rgb(226,135,67)')
  // .attr('fill', 'rgb(226,135,67)')
  // .attr('d', d3.arc()({     
  //     innerRadius: 7,
  //     outerRadius: 5, 
  //     startAngle: Math.PI * 2.5, 
  //     endAngle: Math.PI * 3/2
  // }));

  // container.append("xhtml:div")
  // .style("display", 'flex')
  // .style("justify-content", "center")
  // .style("align-items", "center")
  // .style("flex-direction", "column")

  // .style("height", "249px")
  // .style("border", '1px solid')
  // .style("padding-top", "48px")
  // .style("border-radius", "5px")
  // .style("background-color", "white")
  // .html(`
  //     <strong style="font-size: 32px; text-align: center; line-height: 64px;">
  //         Priority matrix not available
  //     </strong>
  //     <span>You received few responses to provide a priority matrix.</span>
  //     <span style="line-height: 46px">Please invite more clients.</span>
  // `);
}

var responses = 18;
if (responses > 19 || fakedata.length < 1) {
    visual();
} else {
    message();
}
